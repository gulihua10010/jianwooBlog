/*!
 * layui.table 
 * 数据表格组件扩展，支持读取响应数据的header，以获取token
 */
;layui.define(["laytpl","laypage","layer","form","util"],function(M){var y=layui.$,J=layui.laytpl,m=layui.laypage,h=layui.layer,A=layui.form,k=layui.util,r=layui.hint(),N=layui.device(),I=layui.setter,q={config:{checkName:"LAY_CHECKED",indexName:"LAY_TABLE_INDEX"},cache:{},index:layui.table?(layui.table.index+10000):0,set:function(Q){var R=this;R.config=y.extend({},R.config,Q);return R},on:function(Q,R){return layui.onevent.call(this,O,Q,R)}},o=function(){var R=this,Q=R.config,S=Q.id||Q.index;if(S){o.that[S]=R;o.config[S]=Q}return{config:Q,reload:function(U,T){R.reload.call(R,U,T)},setColsWidth:function(){R.setColsWidth.call(R)},resize:function(){R.resize.call(R)}}},t=function(R){var Q=o.config[R];if(!Q){r.error(R?("The table instance with ID '"+R+"' not found"):"ID argument required")}return Q||null},H=function(Q,T,R,V){var S=this.config||{};if(S.escape){T=k.escape(T)}var U=Q.templet?function(){return typeof Q.templet==="function"?Q.templet(R):J(y(Q.templet).html()||String(T)).render(R)}():T;return V?y("<div>"+U+"</div>").text():U},O="laytable",j=".layui-table",u="layui-this",f="layui-show",i="layui-hide",x="layui-disabled",D="layui-none",B="layui-table-view",b=".layui-table-tool",K=".layui-table-box",v=".layui-table-init",l=".layui-table-header",g=".layui-table-body",F=".layui-table-main",G=".layui-table-fixed",e=".layui-table-fixed-l",P=".layui-table-fixed-r",c=".layui-table-total",C=".layui-table-page",w=".layui-table-sort",a="layui-table-edit",E="layui-table-hover",p=function(Q){var R='{{#if(item2.colspan){}} colspan="{{item2.colspan}}"{{#} if(item2.rowspan){}} rowspan="{{item2.rowspan}}"{{#}}}';Q=Q||{};return['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<thead>","{{# layui.each(d.data.cols, function(i1, item1){ }}","<tr>","{{# layui.each(item1, function(i2, item2){ }}",'{{# if(item2.fixed && item2.fixed !== "right"){ left = true; } }}','{{# if(item2.fixed === "right"){ right = true; } }}',function(){if(Q.fixed&&Q.fixed!=="right"){return'{{# if(item2.fixed && item2.fixed !== "right"){ }}'}if(Q.fixed==="right"){return'{{# if(item2.fixed === "right"){ }}'}return""}(),"{{# var isSort = !(item2.colGroup) && item2.sort; }}",'<th data-field="{{ item2.field||i2 }}" data-key="{{d.index}}-{{i1}}-{{i2}}" {{# if( item2.parentKey){ }}data-parentkey="{{ item2.parentKey }}"{{# } }} {{# if(item2.minWidth){ }}data-minwidth="{{item2.minWidth}}"{{# } }} '+R+' {{# if(item2.unresize || item2.colGroup){ }}data-unresize="true"{{# } }} class="{{# if(item2.hide){ }}layui-hide{{# } }}{{# if(isSort){ }} layui-unselect{{# } }}{{# if(!item2.field){ }} layui-table-col-special{{# } }}">','<div class="layui-table-cell laytable-cell-',"{{# if(item2.colGroup){ }}","group","{{# } else { }}","{{d.index}}-{{i1}}-{{i2}}",'{{# if(item2.type !== "normal"){ }}'," laytable-cell-{{ item2.type }}","{{# } }}","{{# } }}",'" {{#if(item2.align){}}align="{{item2.align}}"{{#}}}>','{{# if(item2.type === "checkbox"){ }}','<input type="checkbox" name="layTableCheckbox" lay-skin="primary" lay-filter="layTableAllChoose" {{# if(item2[d.data.checkName]){ }}checked{{# }; }}>',"{{# } else { }}",'<span>{{item2.title||""}}</span>',"{{# if(isSort){ }}",'<span class="layui-table-sort layui-inline"><i class="layui-edge layui-table-sort-asc" title="升序"></i><i class="layui-edge layui-table-sort-desc" title="降序"></i></span>',"{{# } }}","{{# } }}","</div>","</th>",(Q.fixed?"{{# }; }}":""),"{{# }); }}","</tr>","{{# }); }}","</thead>","</table>"].join("")},L=['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<tbody></tbody>","</table>"].join(""),s=['<div class="layui-form layui-border-box {{d.VIEW_CLASS}}{{# if(d.data.className){ }} {{ d.data.className }}{{# } }}" lay-filter="LAY-table-{{d.index}}" lay-id="{{ d.data.id }}" style="{{# if(d.data.width){ }}width:{{d.data.width}}px;{{# } }} {{# if(d.data.height){ }}height:{{d.data.height}}px;{{# } }}">',"{{# if(d.data.toolbar){ }}",'<div class="layui-table-tool">','<div class="layui-table-tool-temp"></div>','<div class="layui-table-tool-self"></div>',"</div>","{{# } }}",'<div class="layui-table-box">',"{{# if(d.data.loading){ }}",'<div class="layui-table-init" style="background-color: #fff;">','<i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i>',"</div>","{{# } }}","{{# var left, right; }}",'<div class="layui-table-header">',p(),"</div>",'<div class="layui-table-body layui-table-main">',L,"</div>","{{# if(left){ }}",'<div class="layui-table-fixed layui-table-fixed-l">','<div class="layui-table-header">',p({fixed:true}),"</div>",'<div class="layui-table-body">',L,"</div>","</div>","{{# }; }}","{{# if(right){ }}",'<div class="layui-table-fixed layui-table-fixed-r">','<div class="layui-table-header">',p({fixed:"right"}),'<div class="layui-table-mend"></div>',"</div>",'<div class="layui-table-body">',L,"</div>","</div>","{{# }; }}","</div>","{{# if(d.data.totalRow){ }}",'<div class="layui-table-total">','<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>','<tbody><tr><td><div class="layui-table-cell" style="visibility: hidden;">Total</div></td></tr></tbody>',"</table>","</div>","{{# } }}","{{# if(d.data.page){ }}",'<div class="layui-table-page">','<div id="layui-table-page{{d.index}}"></div>',"</div>","{{# } }}","<style>","{{# layui.each(d.data.cols, function(i1, item1){","layui.each(item1, function(i2, item2){ }}",".laytable-cell-{{d.index}}-{{i1}}-{{i2}}{ ","{{# if(item2.width){ }}","width: {{item2.width}}px;","{{# } }}"," }","{{# });","}); }}","</style>","</div>"].join(""),n=y(window),z=y(document),d=function(Q){var R=this;R.index=++q.index;R.config=y.extend({},R.config,q.config,Q);R.render()};d.prototype.config={limit:10,loading:true,cellMinWidth:60,defaultToolbar:["filter","exports","print"],autoSort:true,text:{none:"无数据"}};d.prototype.render=function(){var U=this,S=U.config;S.elem=y(S.elem);S.where=S.where||{};S.id=S.id||S.elem.attr("id")||U.index;S.request=y.extend({pageName:"page",limitName:"limit"},S.request);S.response=y.extend({statusName:"code",statusCode:0,msgName:"msg",dataName:"data",totalRowName:"totalRow",countName:"count"},S.response);if(typeof S.page==="object"){S.limit=S.page.limit||S.limit;S.limits=S.page.limits||S.limits;U.page=S.page.curr=S.page.curr||1;delete S.page.elem;delete S.page.jump}if(!S.elem[0]){return U}if(S.height&&/^full-\d+$/.test(S.height)){U.fullHeightGap=S.height.split("-")[1];S.height=n.height()-U.fullHeightGap}U.setInit();var V=S.elem,Q=V.next("."+B),R=U.elem=y(J(s).render({VIEW_CLASS:B,data:S,index:U.index}));S.index=U.index;U.key=S.id||S.index;Q[0]&&Q.remove();V.after(R);U.layTool=R.find(b);U.layBox=R.find(K);U.layHeader=R.find(l);U.layMain=R.find(F);U.layBody=R.find(g);U.layFixed=R.find(G);U.layFixLeft=R.find(e);U.layFixRight=R.find(P);U.layTotal=R.find(c);U.layPage=R.find(C);U.renderToolbar();U.fullSize();if(S.cols.length>1){var T=U.layFixed.find(l).find("th");T.height(U.layHeader.height()-1-parseFloat(T.css("padding-top"))-parseFloat(T.css("padding-bottom")))}U.pullData(U.page);U.events()};d.prototype.initOpts=function(T){var S=this,R=S.config,Q={checkbox:48,radio:48,space:15,numbers:40};if(T.checkbox){T.type="checkbox"}if(T.space){T.type="space"}if(!T.type){T.type="normal"}if(T.type!=="normal"){T.unresize=true;T.width=T.width||Q[T.type]}};d.prototype.setInit=function(R){var S=this,Q=S.config;Q.clientWidth=Q.width||function(){var T=function(W){var V,U;W=W||Q.elem.parent();V=W.width();try{U=W.css("display")==="none"}catch(X){}if(W[0]&&(!V||U)){return T(W.parent())}return V};return T()}();if(R==="width"){return Q.clientWidth}layui.each(Q.cols,function(U,T){layui.each(T,function(W,V){if(!V){T.splice(W,1);return}V.key=U+"-"+W;V.hide=V.hide||false;if(V.colGroup||V.colspan>1){var X=0;layui.each(Q.cols[U+1],function(Z,Y){if(Y.HAS_PARENT||(X>1&&X==V.colspan)){return}Y.HAS_PARENT=true;Y.parentKey=U+"-"+W;X=X+parseInt(Y.colspan>1?Y.colspan:1)});V.colGroup=true}S.initOpts(V)})})};d.prototype.renderToolbar=function(){var V=this,S=V.config;var R=['<div class="layui-inline" lay-event="add"><i class="layui-icon layui-icon-add-1"></i></div>','<div class="layui-inline" lay-event="update"><i class="layui-icon layui-icon-edit"></i></div>','<div class="layui-inline" lay-event="delete"><i class="layui-icon layui-icon-delete"></i></div>'].join(""),W=V.layTool.find(".layui-table-tool-temp");if(S.toolbar==="default"){W.html(R)}else{if(typeof S.toolbar==="string"){var T=y(S.toolbar).html()||"";T&&W.html(J(T).render(S))}}var U={filter:{title:"筛选列",layEvent:"LAYTABLE_COLS",icon:"layui-icon-cols"},exports:{title:"导出",layEvent:"LAYTABLE_EXPORT",icon:"layui-icon-export"},print:{title:"打印",layEvent:"LAYTABLE_PRINT",icon:"layui-icon-print"}},Q=[];if(typeof S.defaultToolbar==="object"){layui.each(S.defaultToolbar,function(Y,Z){var X=typeof Z==="string"?U[Z]:Z;if(X){Q.push('<div class="layui-inline" title="'+X.title+'" lay-event="'+X.layEvent+'"><i class="layui-icon '+X.icon+'"></i></div>')}})}V.layTool.find(".layui-table-tool-self").html(Q.join(""))};d.prototype.setParentCol=function(S,W){var T=this,Y=T.config,R=T.layHeader.find('th[data-key="'+Y.index+"-"+W+'"]'),U=parseInt(R.attr("colspan"))||0;if(R[0]){var X=W.split("-"),V=Y.cols[X[0]][X[1]];S?U--:U++;R.attr("colspan",U);R[U<1?"addClass":"removeClass"](i);V.colspan=U;V.hide=U<1;var Q=R.data("parentkey");Q&&T.setParentCol(S,Q)}};d.prototype.setColsPatch=function(){var R=this,Q=R.config;layui.each(Q.cols,function(T,S){layui.each(S,function(V,U){if(U.hide){R.setParentCol(U.hide,U.parentKey)}})})};d.prototype.setColsWidth=function(){var W=this,ab=W.config,V=0,Q=0,X=0,Z=0,aa=W.setInit("width");W.eachCols(function(ac,ad){ad.hide||V++});aa=aa-function(){return(ab.skin==="line"||ab.skin==="nob")?2:V+1}()-W.getScrollWidth(W.layMain[0])-1;var T=function(ac){layui.each(ab.cols,function(ae,ad){layui.each(ad,function(ai,af){var ah=0,ag=af.minWidth||ab.cellMinWidth;if(!af){ad.splice(ai,1);return}if(af.colGroup||af.hide){return}if(!ac){ah=af.width||0;if(/\d+%$/.test(ah)){ah=Math.floor((parseFloat(ah)/100)*aa);ah<ag&&(ah=ag)}else{if(!ah){af.width=ah=0;Q++}}}else{if(X&&X<ag){Q--;ah=ag}}if(af.hide){ah=0}Z=Z+ah})});(aa>Z&&Q)&&(X=(aa-Z)/Q)};T();T(true);W.autoColNums=Q;W.eachCols(function(ad,ac){var ae=ac.minWidth||ab.cellMinWidth;if(ac.colGroup||ac.hide){return}if(ac.width===0){W.getCssRule(ab.index+"-"+ac.key,function(af){af.style.width=Math.floor(X>=ae?X:ae)+"px"})}else{if(/\d+%$/.test(ac.width)){W.getCssRule(ab.index+"-"+ac.key,function(af){af.style.width=Math.floor((parseFloat(ac.width)/100)*aa)+"px"})}}});var U=W.layMain.width()-W.getScrollWidth(W.layMain[0])-W.layMain.children("table").outerWidth();if(W.autoColNums&&U>=-V&&U<=V){var R=function(ac){var ad;ac=ac||W.layHeader.eq(0).find("thead th:last-child");ad=ac.data("field");if(!ad&&ac.prev()[0]){return R(ac.prev())}return ac},S=R(),Y=S.data("key");W.getCssRule(Y,function(ad){var ac=ad.style.width||S.outerWidth();ad.style.width=(parseFloat(ac)+U)+"px";if(W.layMain.height()-W.layMain.prop("clientHeight")>0){ad.style.width=(parseFloat(ad.style.width)-1)+"px"}})}W.loading(!0)};d.prototype.resize=function(){var Q=this;Q.fullSize();Q.setColsWidth();Q.scrollPatch()};d.prototype.reload=function(R,Q){var S=this;R=R||{};delete S.haveInit;layui.each(R,function(T,U){if(layui._typeof(U)==="array"){delete S.config[T]}});S.config=y.extend(Q,{},S.config,R);S.render()};d.prototype.errorView=function(R){var S=this,T=S.layMain.find("."+D),Q=y('<div class="'+D+'">'+(R||"Error")+"</div>");if(T[0]){S.layNone.remove();T.remove()}S.layFixed.addClass(i);S.layMain.find("tbody").html("");S.layMain.append(S.layNone=Q);q.cache[S.key]=[]};d.prototype.page=1;d.prototype.pullData=function(Y){var V=this,Z=V.config,S=Z.request,R=Z.response,U=function(){if(typeof Z.initSort==="object"){V.sort(Z.initSort.field,Z.initSort.type)}};V.startTime=new Date().getTime();if(Z.url){var Q={};Q[S.pageName]=Y;Q[S.limitName]=Z.limit;var T=y.extend(Q,Z.where);if(Z.contentType&&Z.contentType.indexOf("application/json")==0){T=JSON.stringify(T)}if(I){Z.headers=Z.headers||{};Z.headers[I.request.tokenName]=I.request.tokenName in Z.headers?Z.headers[I.request.tokenName]:(layui.data(I.tableName)[I.request.tokenName]||"");Z.headers[I.request.refreshTokenName]=I.request.refreshTokenName in Z.headers?Z.headers[I.request.refreshTokenName]:(layui.data(I.tableName)[I.request.refreshTokenName]||"")}V.loading();y.ajax({type:Z.method||"get",url:Z.url,contentType:Z.contentType,data:T,dataType:"json",headers:Z.headers,success:function(aa){if(typeof Z.parseData==="function"){aa=Z.parseData(aa)||aa}if(aa[R.statusName]!=R.statusCode){V.renderForm();V.errorView(aa[R.msgName]||('返回的数据不符合规范，正确的成功状态码应为："'+R.statusName+'": '+R.statusCode))}else{V.renderData(aa,Y,aa[R.countName]),U();Z.time=(new Date().getTime()-V.startTime)+" ms"}V.setColsWidth();typeof Z.done==="function"&&Z.done(aa,Y,aa[R.countName])},error:function(aa,ab){V.errorView("请求异常，错误提示："+ab);V.renderForm();V.setColsWidth();var ac=aa.responseJSON;if(ac&&ac.status==I.response.statusCode.logout){layui.view&&layui.view.exit()}typeof Z.error==="function"&&Z.error(aa,ab)},complete:function(ac,ab){var aa=ac.getResponseHeader(I.request.refreshAccessTokenName);if(aa){layui.data(I.tableName,{key:I.request.tokenName,value:aa})}}})}else{if(layui._typeof(Z.data)==="array"){var X={},W=Y*Z.limit-Z.limit;X[R.dataName]=Z.data.concat().splice(W,Z.limit);X[R.countName]=Z.data.length;if(typeof Z.totalRow==="object"){X[R.totalRowName]=y.extend({},Z.totalRow)}V.renderData(X,Y,X[R.countName]),U();V.setColsWidth();typeof Z.done==="function"&&Z.done(X,Y,X[R.countName])}}};d.prototype.eachCols=function(R){var Q=this;q.eachCols(null,R,Q.config.cols);return Q};d.prototype.renderData=function(X,aa,V,S){var W=this,ab=W.config,R=X[ab.response.dataName]||[],Z=X[ab.response.totalRowName],U=[],T=[],Y=[],Q=function(){var ac;if(!S&&W.sortKey){return W.sort(W.sortKey.field,W.sortKey.sort,true)}layui.each(R,function(ai,af){var ah=[],ad=[],ag=[],ae=ai+ab.limit*(aa-1)+1;if(layui._typeof(af)==="array"&&af.length===0){return}if(!S){af[q.config.indexName]=ai}W.eachCols(function(al,aj){var an=aj.field||al,ak=ab.index+"-"+aj.key,am=af[an];if(am===undefined||am===null){am=""}if(aj.colGroup){return}var ao=['<td data-field="'+an+'" data-key="'+ak+'" '+function(){var ap=[];if(aj.edit){ap.push('data-edit="'+aj.edit+'"')}if(aj.align){ap.push('align="'+aj.align+'"')}if(aj.templet){ap.push('data-content="'+am+'"')}if(aj.toolbar){ap.push('data-off="true"')}if(aj.event){ap.push('lay-event="'+aj.event+'"')}if(aj.style){ap.push('style="'+aj.style+'"')}if(aj.minWidth){ap.push('data-minwidth="'+aj.minWidth+'"')}return ap.join(" ")}()+' class="'+function(){var ap=[];if(aj.hide){ap.push(i)}if(!aj.field){ap.push("layui-table-col-special")}return ap.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){return aj.type==="normal"?ak:(ak+" laytable-cell-"+aj.type)}()+'">'+function(){var ap=y.extend(true,{LAY_INDEX:ae,LAY_COL:aj},af),aq=q.config.checkName;switch(aj.type){case"checkbox":return'<input type="checkbox" name="layTableCheckbox" lay-skin="primary" '+function(){if(aj[aq]){af[aq]=aj[aq];return aj[aq]?"checked":""}return ap[aq]?"checked":""}()+">";break;case"radio":if(ap[aq]){ac=ai}return'<input type="radio" name="layTableRadio_'+ab.index+'" '+(ap[aq]?"checked":"")+' lay-type="layTableRadio">';break;case"numbers":return ae;break}if(aj.toolbar){return J(y(aj.toolbar).html()||"").render(ap)}return H.call(W,aj,am,ap)}(),"</div></td>"].join("");ah.push(ao);if(aj.fixed&&aj.fixed!=="right"){ad.push(ao)}if(aj.fixed==="right"){ag.push(ao)}});U.push('<tr data-index="'+ai+'">'+ah.join("")+"</tr>");T.push('<tr data-index="'+ai+'">'+ad.join("")+"</tr>");Y.push('<tr data-index="'+ai+'">'+ag.join("")+"</tr>")});W.layBody.scrollTop(0);W.layMain.find("."+D).remove();W.layMain.find("tbody").html(U.join(""));W.layFixLeft.find("tbody").html(T.join(""));W.layFixRight.find("tbody").html(Y.join(""));W.renderForm();typeof ac==="number"&&W.setThisRowChecked(ac);W.syncCheckAll();W.haveInit?W.scrollPatch():setTimeout(function(){W.scrollPatch()},50);W.haveInit=true;h.close(W.tipsIndex);ab.HAS_SET_COLS_PATCH||W.setColsPatch();ab.HAS_SET_COLS_PATCH=true};q.cache[W.key]=R;W.layPage[(V==0||(R.length===0&&aa==1))?"addClass":"removeClass"](i);if(R.length===0){W.renderForm();return W.errorView(ab.text.none)}else{W.layFixed.removeClass(i)}if(S){return Q()}Q();W.renderTotal(R,Z);if(ab.page){ab.page=y.extend({elem:"layui-table-page"+ab.index,count:V,limit:ab.limit,limits:ab.limits||[10,20,30,40,50,60,70,80,90],groups:3,layout:["prev","page","next","skip","count","limit"],prev:'<i class="layui-icon">&#xe603;</i>',next:'<i class="layui-icon">&#xe602;</i>',jump:function(ac,ad){if(!ad){W.page=ac.curr;ab.limit=ac.limit;W.pullData(ac.curr)}}},ab.page);ab.page.count=V;m.render(ab.page)}};d.prototype.renderTotal=function(V,R){var U=this,Q=U.config,T={};if(!Q.totalRow){return}layui.each(V,function(X,W){if(layui._typeof(W)==="array"&&W.length===0){return}U.eachCols(function(Z,Y){var ab=Y.field||Z,aa=W[ab];if(Y.totalRow){T[ab]=(T[ab]||0)+(parseFloat(aa)||0)}})});U.dataTotal={};var S=[];U.eachCols(function(X,W){var Z=W.field||X;var Y=function(){var ae=W.totalRowText||"",ac=parseFloat(T[Z]).toFixed(2),ab={},ad;ab[Z]=ac;ad=W.totalRow?(H.call(U,W,ac,ab)||ae):ae;return R?(R[W.field]||ad):ad}(),aa=['<td data-field="'+Z+'" data-key="'+Q.index+"-"+W.key+'" '+function(){var ab=[];if(W.align){ab.push('align="'+W.align+'"')}if(W.style){ab.push('style="'+W.style+'"')}if(W.minWidth){ab.push('data-minwidth="'+W.minWidth+'"')}return ab.join(" ")}()+' class="'+function(){var ab=[];if(W.hide){ab.push(i)}if(!W.field){ab.push("layui-table-col-special")}return ab.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){var ab=(Q.index+"-"+W.key);return W.type==="normal"?ab:(ab+" laytable-cell-"+W.type)}()+'">'+function(){var ab=W.totalRow||Q.totalRow;if(typeof ab==="string"){return J(ab).render(y.extend({TOTAL_NUMS:Y},W))}return Y}(),"</div></td>"].join("");W.field&&(U.dataTotal[Z]=Y);S.push(aa)});U.layTotal.find("tbody").html("<tr>"+S.join("")+"</tr>")};d.prototype.getColElem=function(S,R){var T=this,Q=T.config;return S.eq(0).find(".laytable-cell-"+(Q.index+"-"+R)+":eq(0)")};d.prototype.renderForm=function(Q){A.render(Q,"LAY-table-"+this.index)};d.prototype.setThisRowChecked=function(R){var S=this,Q=S.config,U="layui-table-click",T=S.layBody.find('tr[data-index="'+R+'"]');T.addClass(U).siblings("tr").removeClass(U)};d.prototype.sort=function(R,Z,ac,S){var V=this,aa,Y={},ad=V.config,Q=ad.elem.attr("lay-filter"),T=q.cache[V.key],U;if(typeof R==="string"){aa=R;V.layHeader.find("th").each(function(af,ag){var ah=y(this),ae=ah.data("field");if(ae===R){R=ah;aa=ae;return false}})}try{var aa=aa||R.data("field"),ab=R.data("key");if(V.sortKey&&!ac){if(aa===V.sortKey.field&&Z===V.sortKey.sort){return}}var X=V.layHeader.find("th .laytable-cell-"+ab).find(w);V.layHeader.find("th").find(w).removeAttr("lay-sort");X.attr("lay-sort",Z||null);V.layFixed.find("th")}catch(W){r.error("Table modules: sort field '"+aa+"' not matched")}V.sortKey={field:aa,sort:Z};if(ad.autoSort){if(Z==="asc"){U=layui.sort(T,aa)}else{if(Z==="desc"){U=layui.sort(T,aa,true)}else{U=layui.sort(T,q.config.indexName);delete V.sortKey}}}Y[ad.response.dataName]=U||T;V.renderData(Y,V.page,V.count,true);if(S){layui.event.call(R,O,"sort("+Q+")",{field:aa,type:Z})}};d.prototype.loading=function(R){var S=this,Q=S.config;if(Q.loading){if(R){S.layInit&&S.layInit.remove();delete S.layInit;S.layBox.find(v).remove()}else{S.layInit=y(['<div class="layui-table-init">','<i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i>',"</div>"].join(""));S.layBox.append(S.layInit)}}};d.prototype.setCheckData=function(R,U){var T=this,Q=T.config,S=q.cache[T.key];if(!S[R]){return}if(layui._typeof(S[R])==="array"){return}S[R][Q.checkName]=U};d.prototype.syncCheckAll=function(){var T=this,Q=T.config,S=T.layHeader.find('input[name="layTableCheckbox"]'),R=function(U){T.eachCols(function(V,W){if(W.type==="checkbox"){W[Q.checkName]=U}});return U};if(!S[0]){return}if(q.checkStatus(T.key).isAll){if(!S[0].checked){S.prop("checked",true);T.renderForm("checkbox")}R(true)}else{if(S[0].checked){S.prop("checked",false);T.renderForm("checkbox")}R(false)}};d.prototype.getCssRule=function(R,V){var T=this,S=T.elem.find("style")[0],Q=S.sheet||S.styleSheet||{},U=Q.cssRules||Q.rules;layui.each(U,function(W,X){if(X.selectorText===(".laytable-cell-"+R)){return V(X),true}})};d.prototype.fullSize=function(){var S=this,R=S.config,Q=R.height,T;if(S.fullHeightGap){Q=n.height()-S.fullHeightGap;if(Q<135){Q=135}S.elem.css("height",Q)}if(!Q){return}T=parseFloat(Q)-(S.layHeader.outerHeight()||38);if(R.toolbar){T=T-(S.layTool.outerHeight()||50)}if(R.totalRow){T=T-(S.layTotal.outerHeight()||40)}if(R.page){T=T-(S.layPage.outerHeight()||41)}S.layMain.css("height",T-2)};d.prototype.getScrollWidth=function(R){var Q=0;if(R){Q=R.offsetWidth-R.clientWidth}else{R=document.createElement("div");R.style.width="100px";R.style.height="100px";R.style.overflowY="scroll";document.body.appendChild(R);Q=R.offsetWidth-R.clientWidth;document.body.removeChild(R)}return Q};d.prototype.scrollPatch=function(){var U=this,S=U.layMain.children("table"),X=U.layMain.width()-U.layMain.prop("clientWidth"),Y=U.layMain.height()-U.layMain.prop("clientHeight"),V=U.getScrollWidth(U.layMain[0]),Q=S.outerWidth()-U.layMain.width(),T=function(Z){if(X&&Y){Z=Z.eq(0);if(!Z.find(".layui-table-patch")[0]){var aa=y('<th class="layui-table-patch"><div class="layui-table-cell"></div></th>');aa.find("div").css({width:X});Z.find("tr").append(aa)}}else{Z.find(".layui-table-patch").remove()}};T(U.layHeader);T(U.layTotal);var W=U.layMain.height(),R=W-Y;U.layFixed.find(g).css("height",S.height()>=R?R:"auto");U.layFixRight[Q>0?"removeClass":"addClass"](i);U.layFixRight.css("right",X-1)};d.prototype.events=function(){var X=this,ad=X.config,T=y("body"),U={},R=X.layHeader.find("th"),Z,ab=".layui-table-cell",S=ad.elem.attr("lay-filter");X.layTool.on("click","*[lay-event]",function(aj){var ai=y(this),ag=ai.attr("lay-event"),ae=function(am){var an=y(am.list),al=y('<ul class="layui-table-tool-panel"></ul>');al.html(an);if(ad.height){al.css("max-height",ad.height-(X.layTool.outerHeight()||50))}ai.find(".layui-table-tool-panel")[0]||ai.append(al);X.renderForm();al.on("click",function(ao){layui.stope(ao)});am.done&&am.done(al,an)};layui.stope(aj);z.trigger("table.tool.panel.remove");h.close(X.tipsIndex);switch(ag){case"LAYTABLE_COLS":ae({list:function(){var al=[];X.eachCols(function(am,an){if(an.field&&an.type=="normal"){al.push('<li><input type="checkbox" name="'+an.field+'" data-key="'+an.key+'" data-parentkey="'+(an.parentKey||"")+'" lay-skin="primary" '+(an.hide?"":"checked")+' title="'+(an.title||an.field)+'" lay-filter="LAY_TABLE_TOOL_COLS"></li>')}});return al.join("")}(),done:function(){A.on("checkbox(LAY_TABLE_TOOL_COLS)",function(ap){var ao=y(ap.elem),an=this.checked,am=ao.data("key"),al=ao.data("parentkey");layui.each(ad.cols,function(ar,aq){layui.each(aq,function(av,at){if(ar+"-"+av===am){var au=at.hide;at.hide=!an;X.elem.find('*[data-key="'+ad.index+"-"+am+'"]')[an?"removeClass":"addClass"](i);if(au!=at.hide){X.setParentCol(!an,al)}X.resize()}})})})}});break;case"LAYTABLE_EXPORT":if(N.ie){h.tips("导出功能不支持 IE，请用 Chrome 等高级浏览器导出",this,{tips:3})}else{ae({list:function(){return['<li data-type="csv">导出到 Csv 文件</li>','<li data-type="xls">导出到 Excel 文件</li>'].join("")}(),done:function(al,am){am.on("click",function(){var an=y(this).data("type");q.exportFile.call(X,ad.id,null,an)})}})}break;case"LAYTABLE_PRINT":var ak=window.open("打印窗口","_blank"),ah=["<style>","body{font-size: 12px; color: #666;}","table{width: 100%; border-collapse: collapse; border-spacing: 0;}","th,td{line-height: 20px; padding: 9px 15px; border: 1px solid #ccc; text-align: left; font-size: 12px; color: #666;}","a{color: #666; text-decoration:none;}","*.layui-hide{display: none}","</style>"].join(""),af=y(X.layHeader.html());af.append(X.layMain.find("table").html());af.append(X.layTotal.find("table").html());af.find("th.layui-table-patch").remove();af.find(".layui-table-col-special").remove();ak.document.write(ah+af.prop("outerHTML"));ak.document.close();ak.print();ak.close();break}layui.event.call(this,O,"toolbar("+S+")",y.extend({event:ag,config:ad},{}))});R.on("mousemove",function(ah){var ag=y(this),ae=ag.offset().left,af=ah.clientX-ae;if(ag.data("unresize")||U.resizeStart){return}U.allowResize=ag.width()-af<=10;T.css("cursor",(U.allowResize?"col-resize":""))}).on("mouseleave",function(){var ae=y(this);if(U.resizeStart){return}T.css("cursor","")}).on("mousedown",function(ag){var af=y(this);if(U.allowResize){var ae=af.data("key");ag.preventDefault();U.resizeStart=true;U.offset=[ag.clientX,ag.clientY];X.getCssRule(ae,function(ai){var ah=ai.style.width||af.outerWidth();U.rule=ai;U.ruleWidth=parseFloat(ah);U.minWidth=af.data("minwidth")||ad.cellMinWidth})}});z.on("mousemove",function(af){if(U.resizeStart){af.preventDefault();if(U.rule){var ae=U.ruleWidth+af.clientX-U.offset[0];if(ae<U.minWidth){ae=U.minWidth}U.rule.style.width=ae+"px";h.close(X.tipsIndex)}Z=1}}).on("mouseup",function(ae){if(U.resizeStart){U={};T.css("cursor","");X.scrollPatch()}if(Z===2){Z=null}});R.on("click",function(ai){var ag=y(this),ah=ag.find(w),ae=ah.attr("lay-sort"),af;if(!ah[0]||Z===1){return Z=2}if(ae==="asc"){af="desc"}else{if(ae==="desc"){af=null}else{af="asc"}}X.sort(ag,af,null,true)}).find(w+" .layui-edge ").on("click",function(ah){var af=y(this),ae=af.index(),ag=af.parents("th").eq(0).data("field");layui.stope(ah);if(ae===0){X.sort(ag,"asc",null,true)}else{X.sort(ag,"desc",null,true)}});var aa=function(af){var ai=y(this),ae=ai.parents("tr").eq(0).data("index"),ah=X.layBody.find('tr[data-index="'+ae+'"]'),ag=q.cache[X.key]||[];ag=ag[ae]||{};return y.extend({tr:ah,data:q.clearCacheKey(ag),del:function(){q.cache[X.key][ae]=[];ah.remove();X.scrollPatch()},update:function(aj){aj=aj||{};layui.each(aj,function(al,am){if(al in ag){var ak,an=ah.children('td[data-field="'+al+'"]');ag[al]=am;X.eachCols(function(ap,ao){if(ao.field==al&&ao.templet){ak=ao.templet}});an.children(ab).html(H.call(X,{templet:ak},am,ag));an.data("content",am)}})}},af)};X.elem.on("click",'input[name="layTableCheckbox"]+',function(){var ai=y(this).prev(),ah=X.layBody.find('input[name="layTableCheckbox"]'),af=ai.parents("tr").eq(0).data("index"),ag=ai[0].checked,ae=ai.attr("lay-filter")==="layTableAllChoose";if(ae){ah.each(function(aj,ak){ak.checked=ag;X.setCheckData(aj,ag)});X.syncCheckAll();X.renderForm("checkbox")}else{X.setCheckData(af,ag);X.syncCheckAll()}layui.event.call(ai[0],O,"checkbox("+S+")",aa.call(ai[0],{checked:ag,type:ae?"all":"one"}))});X.elem.on("click",'input[lay-type="layTableRadio"]+',function(){var af=y(this).prev(),ah=af[0].checked,ag=q.cache[X.key],ae=af.parents("tr").eq(0).data("index");layui.each(ag,function(ai,aj){if(ae===ai){aj[ad.checkName]=true}else{delete aj[ad.checkName]}});X.setThisRowChecked(ae);layui.event.call(this,O,"radio("+S+")",aa.call(this,{checked:ah}))});X.layBody.on("mouseenter","tr",function(){var af=y(this),ae=af.index();if(af.data("off")){return}X.layBody.find("tr:eq("+ae+")").addClass(E)}).on("mouseleave","tr",function(){var af=y(this),ae=af.index();if(af.data("off")){return}X.layBody.find("tr:eq("+ae+")").removeClass(E)}).on("click","tr",function(){W.call(this,"row")}).on("dblclick","tr",function(){W.call(this,"rowDouble")});var W=function(ae){var af=y(this);if(af.data("off")){return}layui.event.call(this,O,ae+"("+S+")",aa.call(af.children("td")[0]))};X.layBody.on("change","."+a,function(){var ah=y(this),ag=this.value,ai=ah.parent().data("field"),ae=ah.parents("tr").eq(0).data("index"),af=q.cache[X.key][ae];af[ai]=ag;layui.event.call(this,O,"edit("+S+")",aa.call(this,{value:ag,field:ai}))}).on("blur","."+a,function(){var ae,ai=y(this),ag=this,aj=ai.parent().data("field"),af=ai.parents("tr").eq(0).data("index"),ah=q.cache[X.key][af];X.eachCols(function(ak,al){if(al.field==aj&&al.templet){ae=al.templet}});ai.siblings(ab).html(function(ak){return H.call(X,{templet:ae},ak,ah)}(ag.value));ai.parent().data("content",ag.value);ai.remove()});X.layBody.on("click","td",function(aj){var ah=y(this),ai=ah.data("field"),af=ah.data("edit"),ag=ah.children(ab);if(ah.data("off")){return}if(af){var ae=y('<input class="layui-input '+a+'">');ae[0].value=ah.data("content")||ag.text();ah.find("."+a)[0]||ah.append(ae);ae.focus();layui.stope(aj);return}}).on("mouseenter","td",function(){Q.call(this)}).on("mouseleave","td",function(){Q.call(this,"hide")});var ac="layui-table-grid",V="layui-table-grid-down",Y="layui-table-grid-panel",Q=function(af){var ag=y(this),ae=ag.children(ab);if(ag.data("off")){return}if(af){ag.find(".layui-table-grid-down").remove()}else{if(ae.prop("scrollWidth")>ae.outerWidth()){if(ae.find("."+V)[0]){return}ag.append('<div class="'+V+'"><i class="layui-icon layui-icon-down"></i></div>')}}};X.layBody.on("click","."+V,function(ag){var af=y(this),ah=af.parent(),ae=ah.children(ab);X.tipsIndex=h.tips(['<div class="layui-table-tips-main" style="margin-top: -'+(ae.height()+16)+"px;"+function(){if(ad.size==="sm"){return"padding: 4px 15px; font-size: 12px;"}if(ad.size==="lg"){return"padding: 14px 15px;"}return""}()+'">',ae.html(),"</div>",'<i class="layui-icon layui-table-tips-c layui-icon-close"></i>'].join(""),ae[0],{tips:[3,""],time:-1,anim:-1,maxWidth:(N.ios||N.android)?300:X.elem.width()/2,isOutAnim:false,skin:"layui-table-tips",success:function(ai,aj){ai.find(".layui-table-tips-c").on("click",function(){h.close(aj)})}});layui.stope(ag)});X.layBody.on("click","*[lay-event]",function(){var af=y(this),ae=af.parents("tr").eq(0).data("index");layui.event.call(this,O,"tool("+S+")",aa.call(this,{event:af.attr("lay-event")}));X.setThisRowChecked(ae)});X.layMain.on("scroll",function(){var ae=y(this),ag=ae.scrollLeft(),af=ae.scrollTop();X.layHeader.scrollLeft(ag);X.layTotal.scrollLeft(ag);X.layFixed.find(g).scrollTop(af);h.close(X.tipsIndex)});n.on("resize",function(){X.resize()})};(function(){z.on("click",function(){z.trigger("table.remove.tool.panel")});z.on("table.remove.tool.panel",function(){y(".layui-table-tool-panel").remove()})})();q.init=function(T,S){S=S||{};var U=this,V=null,R=T?y('table[lay-filter="'+T+'"]'):y(j+"[lay-data]"),Q="Table element property lay-data configuration item has a syntax error: ";R.each(function(){var Y=y(this),X=Y.attr("lay-data");try{X=new Function("return "+X)()}catch(aa){r.error(Q+X,"error")}var Z=[],W=y.extend({elem:this,cols:[],data:[],skin:Y.attr("lay-skin"),size:Y.attr("lay-size"),even:typeof Y.attr("lay-even")==="string"},q.config,S,X);T&&Y.hide();Y.find("thead>tr").each(function(ab){W.cols[ab]=[];y(this).children().each(function(ad){var ae=y(this),ac=ae.attr("lay-data");try{ac=new Function("return "+ac)()}catch(af){return r.error(Q+ac)}var ag=y.extend({title:ae.text(),colspan:ae.attr("colspan")||0,rowspan:ae.attr("rowspan")||0},ac);if(ag.colspan<2){Z.push(ag)}W.cols[ab].push(ag)})});Y.find("tbody>tr").each(function(ab){var ac=y(this),ad={};ac.children("td").each(function(af,ae){var ah=y(this),ag=ah.data("field");if(ag){return ad[ag]=ah.html()}});layui.each(Z,function(af,ae){var ag=ac.children("td").eq(af);ad[ae.field]=ag.html()});W.data[ab]=ad});q.render(W)});return U};o.that={};o.config={};q.eachCols=function(W,V,U){var S=o.config[W]||{},R=[],Q=0;U=y.extend(true,[],U||S.cols);layui.each(U,function(Y,X){layui.each(X,function(aa,Z){if(Z.colGroup){var ab=0;Q++;Z.CHILD_COLS=[];layui.each(U[Y+1],function(ad,ac){if(ac.PARENT_COL_INDEX||(ab>1&&ab==Z.colspan)){return}ac.PARENT_COL_INDEX=Q;Z.CHILD_COLS.push(ac);ab=ab+parseInt(ac.colspan>1?ac.colspan:1)})}if(Z.PARENT_COL_INDEX){return}R.push(Z)})});var T=function(X){layui.each(X||R,function(Y,Z){if(Z.CHILD_COLS){return T(Z.CHILD_COLS)}typeof V==="function"&&V(Y,Z)})};T()};q.checkStatus=function(U){var T=0,R=0,Q=[],S=q.cache[U]||[];layui.each(S,function(V,W){if(layui._typeof(W)==="array"){R++;return}if(W[q.config.checkName]){T++;Q.push(q.clearCacheKey(W))}});return{data:Q,isAll:S.length?(T===(S.length-R)):false}};q.getData=function(S){var Q=[],R=q.cache[S]||[];layui.each(R,function(T,U){if(layui._typeof(U)==="array"){return}Q.push(q.clearCacheKey(U))});return Q};q.exportFile=function(X,U,S){var T=this;U=U||q.clearCacheKey(q.cache[X]);S=S||"csv";var W=o.that[X],Q=o.config[X]||{},V=({csv:"text/csv",xls:"application/vnd.ms-excel"})[S],R=document.createElement("a");if(N.ie){return r.error("IE_NOT_SUPPORT_EXPORTS")}R.href="data:"+V+";charset=utf-8,\ufeff"+encodeURIComponent(function(){var aa=[],Z=[],Y=[];layui.each(U,function(ac,ab){var ad=[];if(typeof X==="object"){layui.each(X,function(ae,af){ac==0&&aa.push(af||"")});layui.each(q.clearCacheKey(ab),function(af,ae){ad.push('"'+(ae||"")+'"')})}else{q.eachCols(X,function(af,ae){if(ae.field&&ae.type=="normal"&&!ae.hide){var ag=ab[ae.field];if(ag===undefined||ag===null){ag=""}ac==0&&aa.push(ae.title||"");ad.push('"'+H.call(W,ae,ag,ab,"text")+'"')}})}Z.push(ad.join(","))});layui.each(T.dataTotal,function(ab,ac){Y.push(ac)});return aa.join(",")+"\r\n"+Z.join("\r\n")+"\r\n"+Y.join(",")}());R.download=(Q.title||"table_"+(Q.index||""))+"."+S;document.body.appendChild(R);R.click();document.body.removeChild(R)};q.resize=function(R){if(R){var Q=t(R);if(!Q){return}o.that[R].resize()}else{layui.each(o.that,function(){this.resize()})}};q.reload=function(U,S,Q){var R=t(U);if(!R){return}var T=o.that[U];T.reload(S,Q);return o.call(T)};q.render=function(Q){var R=new d(Q);return o.call(R)};q.clearCacheKey=function(Q){Q=y.extend({},Q);delete Q[q.config.checkName];delete Q[q.config.indexName];return Q};y(function(){q.init()});M(O,q)});