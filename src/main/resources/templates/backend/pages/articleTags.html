<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta content="webkit" name="renderer">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0"
          name="viewport">
    <link href="/static/plugins/layuiadmin/layui/css/layui.css" media="all" rel="stylesheet">
    <link href="/static/css/admin.css" media="all" rel="stylesheet">
    <title>文章标签</title>
</head>
<body>
<div class="art-tags">
    <p>文章标签</p>
    <div id="tagscontent">
        <ul>
            <li th:each="tag:${tags}">
                <span th:text="${tag.content}"></span>
                <span class="tags-id" style="display: none" th:text="${tag.oid}"></span>
                <div>
                    <button class="layui-btn layui-btn-danger">删除</button>
                </div>
            </li>
            <li class="addtags"><i class="iconfont">&#xe613;</i></li>
        </ul>

    </div>

</div>
<script src="/static/plugins/layuiadmin/layui/layui.js"></script>
<script src="/static/js/common.js" type="text/javascript"></script>
<script>
    layui.use(['layer', 'form', 'element', 'upload'], function () {
        var form = layui.form
            , $ = layui.jquery;
        $('.addtags').click(function () {
            var index = layer.open({
                title: ['添加标签', 'font-size:16px'],
                type: 1,
                closeBtn: 2,
                skin: 'layui-layer-rim', //加上边框
                area: ['320px', '200px'], //宽高
                content: '<form id="tagsform" method="post"> ' +
                    '<input type="text" id="tagText" name="tagText" class="form-control addinput">' +
                    '<span id="tips"></span></form>' +
                    '<button class="layui-btn addbtn" type="button" id="addbtnsure">添加</button> ' +
                    '<button class="layui-btn layui-btn-primary addbtncal" id="addbtncal">取消</button>'
            })
            $('#addbtnsure').click(function () {
                if ($('#tagText').val() == null || $('#tagText').val().length < 1) {
                    $('#tips').html("标签名不能为空")
                } else {

                    ajaxPost(
                        '/api/admin/tag/add',
                        JSON.stringify({tagText: $('#tagText').val()}),
                        "添加成功",
                        function () {
                            location.reload();
                        }
                    );
                }


            })
            $('#addbtncal').click(function () {
                layer.close(layer.index)
            })

        })
        $('div.art-tags>div>ul>li>div>button ').click(function () {
            $a = $(this).parent().parent();
            var oid = $a.children('.tags-id').text();
            // alert($val);
            alert_ask('确定要删除吗?', function () {
                var menuli = $('#menuliform').serialize();
                ajaxPost(
                    '/api/admin/tag/remove',
                    JSON.stringify({entityOid: oid}),
                    "删除成功",
                    function () {
                        location.reload();
                    }
                );
                // $a.css('display','none');
                // layer.closeAll();
            })
        })
    })
</script>
</body>
</html>